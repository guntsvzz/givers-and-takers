<!-- Main Search Section -->
<div class="auth-container-wrapper">
  <div class="auth-container">
    <div class="main-search">
      <h1>Find Takers and Non-profits</h1>
      
      <!-- Search Bar -->
      <div class="search-bar">
        <%= form_with url: search_path, method: :get, local: true do |form| %>
          <%= form.text_field :query, placeholder: "Search", value: params[:query], class: "search-input" %>
          <%= form.submit "Search", class: "search-btn" %>
          <%= link_to "New request", new_request_path %>
        <% end %>
      </div>
    </div>
  </div>

<!-- Content Cards Section -->
<div class="content-cards">
  <!-- Highlighted first card -->
  <% if @requests.present? %>
    <%= link_to request_path(@requests.first), class: "card-link" do %>
      <div class="card highlight">
        <!-- Fallback to 'default_image.png' if image_url is nil or blank -->
        <%= image_tag @requests.first.image_url.presence || 'default_image.png', alt: "Image for #{@requests.first.title}" %>
        <h3><%= @requests.first.title %></h3>
        
        <!-- Progress Bar for the first card -->
        <div style="background-color: #e0e0e0; border-radius: 10px; height: 20px; width: 100%; margin: 10px 0;">
          <div style="background-color: #4caf50; height: 100%; width: <%= [(@requests.first.interests.where(status: 1).sum(:quantity).to_f / @requests.first.quantity * 100).round(2), 100].min %>%; border-radius: 10px;"></div>
        </div>

        <p><%= @requests.first.taker.organization_name %> is an organizer</p>
      </div>
    <% end %>

    <!-- Regular cards for the rest -->
    <% @requests[1..-1].each do |request| %>
      <%= link_to request_path(request), class: "card-link" do %>
        <div class="card">
          <!-- Fallback to 'default_image.png' if image_url is nil or blank -->
          <%= image_tag request.image_url.presence || 'default_image.png', alt: "Image for #{request.title}" %>
          <h3><%= request.title %></h3>

          <!-- Progress Bar for each additional card -->
          <div style="background-color: #e0e0e0; border-radius: 10px; height: 20px; width: 100%; margin: 10px 0;">
            <div style="background-color: #4caf50; height: 100%; width: <%= [(request.interests.where(status: 1).sum(:quantity).to_f / request.quantity * 100).round(2), 100].min %>%; border-radius: 10px;"></div>
          </div>

          <p><%= request.taker.organization_name %> is an organizer</p>
        </div>
      <% end %>
    <% end %>
  <% else %>
    <p>No requests available.</p>
  <% end %>
</div>
</div>